沒問題，我已經將程式碼還原到第一版（原本的黑名單管理介面、配色與功能），只單純修改了網頁標題為「台南環保局非法棄置智慧圍籬系統」。

您可以直接複製以下程式碼：

HTML

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台南環保局非法棄置智慧圍籬系統</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; font-family: "Microsoft JhengHei", sans-serif; }
        /* 維持第一版的配色 */
        .header-section { background-color: #2c3e50; color: white; padding: 20px 0; margin-bottom: 20px; }
        .card { box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: none; }
        .btn-action { margin-right: 5px; }
        .status-badge-active { background-color: #198754; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.85em; }
        .status-badge-inactive { background-color: #6c757d; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.85em; }
    </style>
</head>
<body>

<div class="header-section">
    <div class="container">
        <h2 class="m-0"><i class="fas fa-car-side me-2"></i>台南環保局非法棄置智慧圍籬系統</h2>
        <p class="m-0 text-white-50">車輛黑名單維護、查詢與批次作業</p>
    </div>
</div>

<div class="container mb-5">
    
    <div class="card p-4 mb-4">
        <div class="row g-3 align-items-end">
            <div class="col-md-4">
                <label class="form-label fw-bold">黑名單查詢</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                    <input type="text" id="searchInput" class="form-control" placeholder="輸入車牌號碼搜尋..." onkeyup="filterTable()">
                </div>
            </div>
            
            <div class="col-md-8 text-md-end">
                <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addModal">
                    <i class="fas fa-plus me-1"></i> 單筆新增
                </button>
                
                <button class="btn btn-success me-2" onclick="document.getElementById('csvFileInput').click()">
                    <i class="fas fa-file-upload me-1"></i> 匯入 CSV
                </button>
                <input type="file" id="csvFileInput" style="display: none" accept=".csv" onchange="handleFileUpload(this)">
                
                <button class="btn btn-outline-secondary me-2" onclick="downloadTemplate()">
                    <i class="fas fa-download me-1"></i> 下載範本
                </button>

                <button class="btn btn-outline-dark" onclick="exportCSV()">
                    <i class="fas fa-file-export me-1"></i> 匯出清單
                </button>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header bg-white fw-bold py-3">
            <i class="fas fa-list me-2"></i> 生效之黑名單清單
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover table-striped mb-0 align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>車牌號碼</th>
                            <th>生效日期</th>
                            <th>結束日期</th>
                            <th>備註</th>
                            <th>上傳人員</th>
                            <th>狀態</th>
                            <th class="text-center">管理功能 (維護)</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        </tbody>
                </table>
            </div>
        </div>
        <div class="card-footer bg-white text-muted small" id="recordCount">
            共 0 筆資料
        </div>
    </div>
</div>

<div class="modal fade" id="addModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">新增黑名單</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="blackListForm">
                    <input type="hidden" id="editIndex"> <div class="mb-3">
                        <label class="form-label">車牌號碼 <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="plateInput" required placeholder="例如：ABC-1234">
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">生效日期 <span class="text-danger">*</span></label>
                            <input type="date" class="form-control" id="startDateInput" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">結束日期</label>
                            <input type="date" class="form-control" id="endDateInput">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">上傳人員 <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="uploaderInput" required value="環保局經辦">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">備註</label>
                        <textarea class="form-control" id="noteInput" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveData()">儲存</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // 1. 模擬資料庫 (Mock Data)
    let blackListData = [
        { plate: "ABC-5678", start: "2023-10-01", end: "2025-10-01", note: "多次違規排放", uploader: "王小明", status: true },
        { plate: "XYZ-9999", start: "2023-11-15", end: "2024-11-15", note: "噪音超標", uploader: "李大華", status: true },
        { plate: "QQ-1234", start: "2023-09-20", end: "", note: "棄置廢棄物嫌疑", uploader: "陳經理", status: false } // 已停用
    ];

    // 初始化
    document.addEventListener('DOMContentLoaded', () => {
        renderTable(blackListData);
        // 設定今天的日期為預設生效日
        document.getElementById('startDateInput').valueAsDate = new Date();
    });

    // 2. 渲染表格 (Render Table)
    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        
        data.forEach((item, index) => {
            const statusBadge = item.status 
                ? `<span class="status-badge-active">生效中</span>` 
                : `<span class="status-badge-inactive">已停用</span>`;
            
            // 處理原始資料中的索引，以便編輯時能找到正確的資料
            // 這裡為了簡單，直接用目前的 index，但在搜尋過濾後需要注意
            
            const row = `
                <tr>
                    <td class="fw-bold text-primary">${item.plate}</td>
                    <td>${item.start}</td>
                    <td>${item.end || '-'}</td>
                    <td>${item.note || '-'}</td>
                    <td>${item.uploader}</td>
                    <td>${statusBadge}</td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-outline-primary btn-action" onclick="openEditModal(${index})">
                            <i class="fas fa-edit"></i> 修改
                        </button>
                        <button class="btn btn-sm ${item.status ? 'btn-outline-danger' : 'btn-outline-success'}" onclick="toggleStatus(${index})">
                            <i class="fas ${item.status ? 'fa-ban' : 'fa-check-circle'}"></i> 
                            ${item.status ? '停用' : '啟用'}
                        </button>
                    </td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
        
        document.getElementById('recordCount').innerText = `共 ${data.length} 筆資料`;
    }

    // 3. 搜尋功能 (Requirement D)
    function filterTable() {
        const keyword = document.getElementById('searchInput').value.toLowerCase();
        const filteredData = blackListData.filter(item => 
            item.plate.toLowerCase().includes(keyword) || 
            item.note.includes(keyword)
        );
        // 注意：這裡簡化了編輯功能的索引對應，實際專案建議每個 item 有唯一 ID
        // 為了演示，我們暫時重新渲染過濾後的資料，但在編輯時會依賴全域資料
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        
        if(filteredData.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4">查無資料</td></tr>';
            return;
        }

        // 重新渲染過濾後的資料 (這裡需要更複雜的邏輯來對應原始 Index，為求簡化，僅供顯示)
        // 在正式開發中，建議使用 Vue.js 或 React 來處理這種狀態同步
        renderTable(filteredData);
    }

    // 4. 新增/儲存邏輯 (Requirement B & C)
    const addModal = new bootstrap.Modal(document.getElementById('addModal'));

    function saveData() {
        const plate = document.getElementById('plateInput').value;
        const start = document.getElementById('startDateInput').value;
        const end = document.getElementById('endDateInput').value;
        const uploader = document.getElementById('uploaderInput').value;
        const note = document.getElementById('noteInput').value;
        const editIndex = document.getElementById('editIndex').value;

        if (!plate || !start || !uploader) {
            alert('請填寫必填欄位 (車牌、生效日、人員)');
            return;
        }

        const newData = { plate, start, end, note, uploader, status: true };

        if (editIndex === "") {
            // 新增
            blackListData.push(newData);
            alert('新增成功！');
        } else {
            // 修改
            blackListData[editIndex] = { ...blackListData[editIndex], ...newData }; // 保留狀態
            alert('修改成功！');
        }

        addModal.hide();
        document.getElementById('blackListForm').reset();
        renderTable(blackListData);
    }

    // 5. 開啟編輯視窗 (Requirement C)
    window.openEditModal = function(index) {
        // 因為搜尋功能可能會改變顯示順序，這裡簡化處理：
        // 在實際系統中，應該用 ID 查找。這裡假設是在未過濾狀態下操作。
        // 如果有過濾，這個 index 可能會錯，這是純 JS 原型常見的限制。
        // 為了演示，建議先清空搜尋框再編輯。
        
        const item = blackListData[index];
        document.getElementById('editIndex').value = index;
        document.getElementById('modalTitle').innerText = "修改黑名單";
        
        document.getElementById('plateInput').value = item.plate;
        document.getElementById('startDateInput').value = item.start;
        document.getElementById('endDateInput').value = item.end;
        document.getElementById('uploaderInput').value = item.uploader;
        document.getElementById('noteInput').value = item.note;
        
        addModal.show();
    }

    // 清空 Modal 狀態 (當按下新增時)
    document.getElementById('addModal').addEventListener('show.bs.modal', function (event) {
        if (!event.relatedTarget) return; // 如果是編輯觸發的 show，不重置
        if (event.relatedTarget.classList.contains('btn-primary')) { // 按下的是新增按鈕
             document.getElementById('blackListForm').reset();
             document.getElementById('editIndex').value = "";
             document.getElementById('modalTitle').innerText = "新增黑名單";
             document.getElementById('startDateInput').valueAsDate = new Date();
             document.getElementById('uploaderInput').value = "環保局經辦";
        }
    });

    // 6. 停用/啟用功能 (Requirement C)
    window.toggleStatus = function(index) {
        blackListData[index].status = !blackListData[index].status;
        renderTable(blackListData);
    }

    // 7. 匯出 CSV (Requirement D)
    function exportCSV() {
        // 加入 BOM (\uFEFF) 讓 Excel 能正確辨識中文
        let csvContent = "\uFEFF車牌號碼,生效日期,結束日期,備註,上傳人員,狀態\n";
        
        blackListData.forEach(item => {
            const statusStr = item.status ? "生效中" : "已停用";
            // 處理備註中可能有逗號的情況
            const safeNote = `"${item.note.replace(/"/g, '""')}"`; 
            const row = `${item.plate},${item.start},${item.end},${safeNote},${item.uploader},${statusStr}`;
            csvContent += row + "\n";
        });

        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `黑名單匯出_${new Date().toISOString().slice(0,10)}.csv`;
        link.click();
    }

    // 8. 下載範本 (Requirement B)
    function downloadTemplate() {
        const csvContent = "\uFEFF車牌號碼,生效日期,結束日期,備註,上傳人員\nExample-123,2023-01-01,2024-01-01,測試備註,王大明";
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "黑名單匯入範本.csv";
        link.click();
    }

    // 9. 匯入 CSV (Requirement B)
    function handleFileUpload(input) {
        const file = input.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const text = e.target.result;
            const rows = text.split('\n');
            let successCount = 0;

            // 跳過標題列 (i=1)
            for (let i = 1; i < rows.length; i++) {
                const cols = rows[i].split(',');
                if (cols.length >= 2 && cols[0].trim() !== '') { // 至少要有車牌和日期
                    const newItem = {
                        plate: cols[0].trim(),
                        start: cols[1].trim(),
                        end: cols[2] ? cols[2].trim() : '',
                        note: cols[3] ? cols[3].replace(/"/g, '').trim() : '',
                        uploader: cols[4] ? cols[4].trim() : 'CSV匯入',
                        status: true
                    };
                    blackListData.push(newItem);
                    successCount++;
                }
            }
            alert(`成功匯入 ${successCount} 筆資料！`);
            renderTable(blackListData);
            input.value = ''; // 重置 input 
        };
        reader.readAsText(file);
    }
</script>

</body>
</html>